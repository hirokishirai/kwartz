<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html">
  <title>Presentation Pattern Catalog</title>
  <meta name="author" content="Makoto Kuwata &lt;kwa(at)kuwata-lab.com&gt;">
  <meta name="generator" content="kwaser">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <link rel="stylesheet" href="docstyle.css" type="text/css">
 </head>
 <body>

  <blockquote>
   <div class="mainbody">

    <div align="left"><h1>Presentation Pattern Catalog</h1></div>
    <div align="left">
      Makoto Kuwata &lt;kwa(at)kuwata-lab.com&gt;<br>
      last update: $Date$<br>
    </div>

<a name="preface"></a>
<h2 class="section1">Preface</h2>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; .mine
Kwartz is the template system which realized the concept of '<strong>Separation of Presentation Logic and Presentation Data (SoPL/PD)</strong>'
or '<strong>Independence of Presentation Logic (IoPL)</strong>.'
SoPL/PD (or IoPL) enables to use complex presentation logics without breaking HTML design at all.
=======
Kwartz is a template system which realized the concept '<strong>Separation of Presentation Logic and Presentation Data (SoPL/PD)</strong>' or '<strong>Independence of Presentation Logic (IoPL)</strong>'.
SoPL/PD (or IoPL) enables to use complex presentation logics without breaking HTML design at all.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; .r95
</p>
<p>There are several patterns which help you to separate presentation logic and presentation data well.
These patterns are called 'Presentation Patterns.'
</p>
<p>This document shows Presentation Patterns.
</p>
<a name="toc"></a>
<h3 class="section2">Table of Contents</h3>
<ul>
  <li><a href="#preface">Preface</a>
  <ul>
    <li><a href="#toc">Table of Contents</a>
    </li>
    <li><a href="#changelog">ChangeLog</a>
    </li>
  </ul>
  </li>
  <li><a href="#replacement">Replacement</a>
  <ul>
    <li><a href="#replace-elem-by-value">Replace Element by Value Pattern</a>
    </li>
  </ul>
  </li>
</ul>
<br>


<a name="changelog"></a>
<h3 class="section2">ChangeLog</h3>
<dl class="dl1">
<dt class="dt1">
2005-06-27</dt>
<dd class="dd1">
	<ul type="circle">
	<li>Wrong output script in the section 'Iterate Element Pattern' is corrected ([bug:1228301]).
	</li>
	<li>'&lt;ul&gt;&lt;/ul&gt;' is changed to '&lt;dl&gt;&lt;/dl&gt;' in the section 'Iterate Content Pattern' ([bug:1228301]).
	</li>
	</ul>
</dd>
</dl>
<dl class="dl1">
<dt class="dt1">
2005-03-21</dt>
<dd class="dd1">
	<ul type="circle">
	<li>add text for Kwartz directives.
	</li>
	<li>add subsubsection title for all patterns.
	</li>
	<li>add 'supplement' subsubsection for 'Replace Element by Value Pattern'.
	</li>
	</ul>
</dd>
</dl>
<br>


<br>


<a name="replacement"></a>
<h2 class="section1">Replacement</h2>
<a name="replace-elem-by-value"></a>
<h3 class="section2">Replace Element by Value Pattern</h3>
<a name="replace-elem-by-value-desc"></a>
<h4 class="section3">Description</h4>
<p>You can replace the element with the value of a variable or an expression.
This is named 'Replace Element by Value Pattern.'
</p>
<br>

<a name="replace-elem-by-value-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern is very useful to print out the value of a variable or an expression as text.
</p>
<br>

<a name="replace-elem-by-value-example"></a>
<h4 class="section3">Example Code</h4>
<a name="teq-replace1.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">Hello &lt;span <strong>id="mark:user"</strong>&gt;World&lt;/span&gt;!
</pre>
<a name="teq-replace1.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#user {
  plogic: {
    <strong>print(username);</strong>  // print value of variable 'username' instead of the element
  }
}
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
Hello &lt;%= username %&gt;!

### for PHP
Hello &lt;?php echo $username; ?&gt;!

### for JSTL
Hello &lt;c:out value="${username}" escapeXml="false"/&gt;!

### for Velocity
Hello $!{username}!
</pre>
<br>

<a name="replace-elem-by-value-suppliment"></a>
<h4 class="section3">Supplement</h4>
<p>The following is an example to print content text as default value when value is null or empty.
This examples is an combination of 'Replace Element by Value Pattern' and 'Delete Tag Pattern'.
</p>
<a name="teq-replace2b.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#user {
  plogic: {
    // Print out value of variable 'username'.
    // Print 'guest' as a default value when 'username' is null or empty string.
    if (username == empty) {
      <strong>@cont;</strong>           // print out content text
    } else {
      <strong>print(username);</strong> // print out value of variable
    }
  }
}
</pre>
<br>

<br>


<a name="replace-cont-by-value"></a>
<h3 class="section2">Replace Content by Value Pattern</h3>
<a name="replace-cont-by-value-desc"></a>
<h4 class="section3">Description</h4>
<p>You can also replace only the content of the element in the same way.
This is named 'Replace Content by Value Pattern.'
</p>
<br>

<a name="replace-cont-by-value-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern is used frequently because the situation to replace the content by value is very popular.
</p>
<br>

<a name="replace-cont-by-value-example"></a>
<h4 class="section3">Example Code</h4>
<a name="teq-replace2.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;h1 <strong>id="mark:title"</strong>&gt;Example&lt;/h1&gt;
</pre>
<a name="teq-replace2.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#title {
  plogic: {
    @stag;
    <strong>print(title);</strong>  // print value of a variable 'title' instead of content
    @etag;
  }
}
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
&lt;h1&gt;&lt;%= title %&gt;&lt;/h1&gt;

### for PHP
&lt;h1&gt;&lt;?php echo $title; ?&gt;&lt;/h1&gt;

### for JSTL
&lt;h1&gt;&lt;c:out value="${title}" escapeXml="false"/&gt;&lt;/h1&gt;

### for Velocity
&lt;h1&gt;$!{title}&lt;/h1&gt;
</pre>
<br>

<a name="replace-cont-by-value-suppliment"></a>
<h4 class="section3">Supplement</h4>
<p>The 'Replace Content by Value Pattern' is to be described as the following in Kwartz.
</p>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#title {
  <strong>value: title;</strong>  // print value of a variable 'title' instead of content
}
</pre>
<p>Kwartz Directive '<code>id="value:<em>expression</em>"</code>' lets you to use this pattern without presentation logic file.
</p>
<a name="teq-replace2b.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;h1 <strong>id="value:title"</strong>&gt;Example&lt;/h1&gt;
</pre>
<br>

<br>


<a name="replace-elem-by-elem"></a>
<h3 class="section2">Replace Element by Element Pattern</h3>
<a name="replace-elem-by-elem-desc"></a>
<h4 class="section3">Description</h4>
<p>You can replace the element by other element.
This pattern is named 'Replace Element by Element Pattern.'
</p>
<br>

<a name="replace-elem-by-elem-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern is very useful to reuse the element in other place.
</p>
<br>

<a name="replace-elem-by-elem-example"></a>
<h4 class="section3">Example Code</h4>
<a name="replace-elem-by-elem.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;div <strong>id="mark:links"</strong>&gt;
 &lt;a href="/"&gt;HOME&lt;/a&gt; | &lt;a href="/doc"&gt;Document&lt;/a&gt; | &lt;a href="/faq"&gt;FAQ&lt;/a&gt;
&lt;/div&gt;

&lt;p&gt;Welcome to my Home Page!&lt;/p&gt;

&lt;div <strong>id="mark:links2"</strong>&gt;
  Home | Document | FAQ
&lt;/div&gt;
</pre>
<a name="replace-elem-by-elem.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#links2 {
  plogic: {
    <strong>@element(links);</strong>  // replace the element 'links2' by the element 'links'
  }
}
</pre>
<p><code>@element(<em>name</em>)</code> represents the element which is marked by <code>id="mark:<em>name</em>"</code> or <code>id="<em>name</em>"</code>.
</p>
<div class="output_caption">
Output Script:</div>
<pre class="output">&lt;div&gt;
 &lt;a href="/"&gt;HOME&lt;/a&gt; | &lt;a href="/doc"&gt;Document&lt;/a&gt; | &lt;a href="/faq"&gt;FAQ&lt;/a&gt;
&lt;/div&gt;

&lt;p&gt;Welcome to my Home Page!&lt;/p&gt;

&lt;div&gt;
 &lt;a href="/"&gt;HOME&lt;/a&gt; | &lt;a href="/doc"&gt;Document&lt;/a&gt; | &lt;a href="/faq"&gt;FAQ&lt;/a&gt;
&lt;/div&gt;
</pre>
<br>

<a name="replace-elem-by-elem-supplement"></a>
<h4 class="section3">Supplement</h4>
<p>Directive '<code>id="replace:<em>name</em>"</code>' lets you to use this pattern without presentation logic file.
</p>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;div <strong>id="mark:links"</strong>&gt;
 &lt;a href="/"&gt;HOME&lt;/a&gt; | &lt;a href="/doc"&gt;Document&lt;/a&gt; | &lt;a href="/faq"&gt;FAQ&lt;/a&gt;
&lt;/div&gt;

&lt;p&gt;Welcome to my Home Page!&lt;/p&gt;

&lt;div <strong>id="replace:links"</strong>&gt;
  Home | Document | FAQ
&lt;/div&gt;
</pre>
<p>The command-line option '<code>-i <em>file</em>,<em>file2</em>,...</code>' enables you to use elements
which are described in other files.
</p>
<a name="links.html"></a>
<div class="program_caption">
Presentation Data(links.html):</div>
<pre class="program">&lt;div <strong>id="mark:links"</strong>&gt;
 &lt;a href="/"&gt;HOME&lt;/a&gt; | &lt;a href="/doc"&gt;Document&lt;/a&gt; | &lt;a href="/faq"&gt;FAQ&lt;/a&gt;
&lt;/div&gt;
</pre>
<a name="page.html"></a>
<div class="program_caption">
Presentation Data(page.html):</div>
<pre class="program">&lt;div <strong>id="mark:links1"</strong>&gt; Home | Document | FAQ &lt;/div&gt;

&lt;p&gt;Welcome to my Home Page!&lt;/p&gt;

&lt;div <strong>id="mark:links2"</strong>&gt; Home | Document | FAQ &lt;/div&gt;
</pre>
<a name="page.plogic"></a>
<div class="program_caption">
Presentation Logic(page.plogic):</div>
<pre class="program">#links1 {
  plogic: {
    <strong>@element(links);</strong>
  }
}
#links2 {
  plogic: {
    <strong>@element(links);</strong>
  }
}
</pre>
<div class="terminal_caption">
Compile:</div>
<pre class="terminal">$ kwartz -l eruby <strong>-i links.html</strong> -p page.plogic page.html
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">&lt;div&gt;
 &lt;a href="/"&gt;HOME&lt;/a&gt; | &lt;a href="/doc"&gt;Document&lt;/a&gt; | &lt;a href="/faq"&gt;FAQ&lt;/a&gt;
&lt;/div&gt;

&lt;p&gt;Welcome to my Home Page!&lt;/p&gt;

&lt;div&gt;
 &lt;a href="/"&gt;HOME&lt;/a&gt; | &lt;a href="/doc"&gt;Document&lt;/a&gt; | &lt;a href="/faq"&gt;FAQ&lt;/a&gt;
&lt;/div&gt;
</pre>
<br>

<br>


<a name="replace-cont-by-elem"></a>
<h3 class="section2">Replace Content by Element Pattern</h3>
<a name="replace-cont-by-elem-desc"></a>
<h4 class="section3">Description</h4>
<p>You can replace content of an element by other element.
This pattern is named 'Replace Content by Element Pattern' or 'Placeholder Pattern.'
</p>
<br>

<a name="replace-cont-by-elem-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern is very useful to separate contents data and design layout into separate files.
</p>
<br>

<a name="replace-cont-by-elem-example"></a>
<h4 class="section3">Example Code</h4>
<p>The following example contains four files.
</p>
<ul type="disc">
<li>contents.html, contents.plogic - repsesents contents data.
</li>
<li>layout.html, layout.plogic - represents desing layout.
</li>
</ul>
<a name="contents.html"></a>
<div class="program_caption">
Presentation Data(contents.html):</div>
<pre class="program">&lt;html&gt;
  &lt;body&gt;
    
    &lt;p&gt;menu:&lt;/p&gt;
    &lt;ul <strong>id="mark:menu"</strong>&gt;
      &lt;li&gt;&lt;a href="..." <strong>id="mark:menu_item"</strong>&gt;menu1&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;article:&lt;/p&gt;
    &lt;div <strong>id="mark:article"</strong>&gt;
      &lt;h2&gt;What is Kwartz?&lt;/h2&gt;
      &lt;p&gt;Kwartz is a template system, which realized the
         concept &lt;strong&gt;`Separation of Presentation Logic
         and Presentation Data'(SoPL/PD)&lt;/strong&gt;.
      &lt;/p&gt;
    &lt;/div&gt;
    
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<a name="contents.plogic"></a>
<div class="program_caption">
Presentation Logic(contents.plogic):</div>
<pre class="program">#menu {
  plogic: {
    @stag;
    foreach (item in menu_list) {
      @cont;
    }
    @etag;
  }
}

#menu_item {
  value:  item['name'];
  attrs:  "href" item['url'];
}
</pre>
<a name="layout.html"></a>
<div class="program_caption">
Presentation Data(layout.html):</div>
<pre class="program">&lt;!doctype html public "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;title id="value:title"&gt;...title...&lt;/title&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"&gt;
    &lt;link rel="stylesheet" type="text/css" href="design.css"&gt;
  &lt;/head&gt;
  &lt;body&gt;

    &lt;table border="0"&gt;
      &lt;tr&gt;
        
        &lt;!-- menu part --&gt;
        &lt;td width="100" valign="top"&gt;
          &lt;div class="menu" <strong>id="mark:placeholder_menu"</strong>&gt;
            &lt;ul&gt;
              &lt;li&gt;menu1&lt;/li&gt;
              &lt;li&gt;menu2&lt;/li&gt;
              &lt;li&gt;menu3&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/div&gt;
        &lt;/td&gt;
        
        &lt;!-- article part --&gt;
        &lt;td width="400" valign="top"&gt;
          &lt;div class="article" <strong>id="mark:placeholder_article"</strong>&gt;
            aaa&lt;br&gt;
            bbb&lt;br&gt;
            ccc&lt;br&gt;
            ddd&lt;br&gt;
          &lt;/div&gt;
        &lt;/td&gt;
        
      &lt;/tr&gt;

      &lt;!-- footer part --&gt;
      &lt;tr&gt;
        &lt;td colspan="2" class="copyright"&gt;
          copyright&amp;copy; 2004-2005 kuwata-lab.com All Rights Reserverd
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
    
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<a name="layout.plogic"></a>
<div class="program_caption">
Presentation Logic(layout.plogic):</div>
<pre class="program">#placeholder_menu {
  plogic: {
    @stag;
    <strong>@element(menu);</strong>   // replace content by other element
    @etag;
 }
}

#placeholder_article {
  plogic: {
    @stag;
    <strong>@element(article);</strong>   // replace content by other element
    @etag;
  }
}
</pre>
<p>Compilation requires the command-line option <code>-i <em>file1,file2,...</em></code>
which enables to import elements defined in other files.
</p>
<p>Compile:
</p>
<pre class="terminal">$ kwartz -l eruby  <strong>-i contents.html</strong> -p contens.plogic,layout.plogic layout.html
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">&lt;!doctype html public "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"&gt;
    &lt;link rel="stylesheet" type="text/css" href="design.css"&gt;
  &lt;/head&gt;
  &lt;body&gt;

    &lt;table border="0"&gt;
      &lt;tr&gt;
        
        &lt;!-- menu part --&gt;
        &lt;td width="100" valign="top"&gt;
          &lt;div class="menu"&gt;
    &lt;ul&gt;
&lt;% for item in menu_list do %&gt;
      &lt;li&gt;&lt;a href="&lt;%= item["url"] %&gt;"&gt;&lt;%= item["name"] %&gt;&lt;/a&gt;&lt;/li&gt;
&lt;% end %&gt;
    &lt;/ul&gt;
          &lt;/div&gt;
        &lt;/td&gt;
        
        &lt;!-- article part --&gt;
        &lt;td width="400" valign="top"&gt;
          &lt;div class="article"&gt;
    &lt;div&gt;
      &lt;h2&gt;What is Kwartz?&lt;/h2&gt;
      &lt;p&gt;Kwartz is a template system, which realized the
         concept &lt;strong&gt;`Separation of Presentation Logic
         and Presentation Data'(SoPL/PD)&lt;/strong&gt;.
      &lt;/p&gt;
    &lt;/div&gt;
          &lt;/div&gt;
        &lt;/td&gt;
        
      &lt;/tr&gt;

      &lt;!-- footer part --&gt;
      &lt;tr&gt;
        &lt;td colspan="2" class="copyright"&gt;
          copyright&amp;copy; 2004-2005 kuwata-lab.com All Rights Reserverd
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
    
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<br>

<a name="replace-cont-by-elem-supplement"></a>
<h4 class="section3">Supplement</h4>
<p>Kwartz Directive '<code>id="placeholder:<em>name</em>"</code>' lets you to use this pattern without presentation logic file(layout.plogic).
</p>
<p>Presentation Data(layout.html):
</p>
<pre class="program">             :
             :
        &lt;!-- menu part --&gt;
        &lt;td width="100" valign="top"&gt;
          &lt;div class="menu" <strong>id="placeholder:menu"</strong>&gt;
            &lt;ul&gt;
              &lt;li&gt;menu1&lt;/li&gt;
              &lt;li&gt;menu2&lt;/li&gt;
              &lt;li&gt;menu3&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/div&gt;
        &lt;/td&gt;
        
        &lt;!-- article part --&gt;
        &lt;td width="400" valign="top"&gt;
          &lt;div class="article" <strong>id="placeholder:article"</strong>&gt;
            aaa&lt;br&gt;
            bbb&lt;br&gt;
            ccc&lt;br&gt;
            ddd&lt;br&gt;
          &lt;/div&gt;
        &lt;/td&gt;
             :
             :
</pre>
<br>

<br>


<br>


<a name="deletion"></a>
<h2 class="section1">Deletion</h2>
<a name="delete-elem"></a>
<h3 class="section2">Delete Element Pattern</h3>
<a name="delete-elem-desc"></a>
<h4 class="section3">Description</h4>
<p>If presentation logic is empty, the element is not printed out.
This pattern is named 'Delete Element Pattern' or 'Dummy Element Pattern.'
</p>
<br>

<a name="delete-elem-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern enables you to use dummy data in presentation data.
</p>
<br>

<a name="delete-elem-example"></a>
<h4 class="section3">Example Code</h4>
<a name="dummy-elem.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;ul&gt;
  &lt;li&gt;foo&lt;/li&gt;
  &lt;li <strong>id="dummy"</strong>&gt;bar&lt;/li&gt;
&lt;/ul&gt;
</pre>
<a name="dummy-elem.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#dummy {
  plogic: {
    // empty
  }
}
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
&lt;ul&gt;
  &lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;

### for PHP
&lt;ul&gt;
  &lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;

### for JSTL
&lt;ul&gt;
  &lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;

### for Velocity
&lt;ul&gt;
  &lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;
</pre>
<br>

<a name="delete-elem-supplement"></a>
<h4 class="section3">Supplement</h4>
<p>Kwartz directive '<code>id="dummy:<em>str</em>"</code>' lets you to use this pattern without presentation logic file.
</p>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;ul&gt;
  &lt;li&gt;foo&lt;/li&gt;
  &lt;li <strong>id="dummy:d1"</strong>&gt;bar&lt;/li&gt;
&lt;/ul&gt;
</pre>
<br>

<br>


<a name="delete-tag"></a>
<h3 class="section2">Delete Tag Pattern</h3>
<a name="delete-tag-desc"></a>
<h4 class="section3">Description</h4>
<p>If you use only <code>@cont</code> and don't use <code>@stag</code> and <code>@cont</code>,
you can remove start and end tags of the element.
This pattern is named 'Delete Tag Pattern' or 'Dummy Tag Pattern.'
</p>
<br>

<a name="delete-tag-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern is very useful if you want to print tags according to condition.
</p>
<br>

<a name="delete-tag-example"></a>
<h4 class="section3">Example Code</h4>
<a name="dummy-tag.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;a href="..." <strong>id="mark:next"</strong>&gt;Next&lt;/a&gt;
</pre>
<a name="dummy-tag.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#next {
  attrs:  "href" url;
  plogic: {
    if (url == null) {
      <strong>@cont;</strong>   // delete tags when url is null
    } else {
      @stag;
      @cont;
      @etag;
    }
  }
}
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
&lt;% if url == nil then %&gt;
Next&lt;% else %&gt;
&lt;a href="&lt;%= url %&gt;"&gt;Next&lt;/a&gt;
&lt;% end %&gt;

### for PHP
&lt;?php if ($url == NULL) { ?&gt;
Next&lt;?php } else { ?&gt;
&lt;a href="&lt;?php echo $url; ?&gt;"&gt;Next&lt;/a&gt;
&lt;?php } ?&gt;

### for JSTL
&lt;c:choose&gt;&lt;c:when test="${url eq null}"&gt;
Next&lt;/c:when&gt;&lt;c:otherwise&gt;
&lt;a href="&lt;c:out value="${url}" escapeXml="false"/&gt;"&gt;Next&lt;/a&gt;
&lt;/c:otherwise&gt;&lt;/c:choose&gt;

### for Velocity
#if($url)
Next#else
&lt;a href="$!{url}"&gt;Next&lt;/a&gt;
#end
</pre>
<br>

<br>


<br>


<a name="iteration"></a>
<h2 class="section1">Iteration</h2>
<a name="iterate-elem"></a>
<h3 class="section2">Iterate Element Pattern</h3>
<a name="iterate-elem-desc"></a>
<h4 class="section3">Description</h4>
<p>Iteration which contains <code>@stag</code>, <code>@cont</code>, and <code>@etag</code> represents to iterate the element.
This pattern is named 'Iterate Element' pattern.
</p>
<br>

<a name="iterate-elem-situation"></a>
<h4 class="section3">Situation</h4>
<p>The situation is very popular which requres to print list items.
This pattern is very useful for all these situations.
</p>
<br>

<a name="iterate-elem-example"></a>
<h4 class="section3">Example Code</h4>
<a name="iterate-elem.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;table&gt;
  &lt;tr <strong>id="mark:items"</strong>&gt;
   &lt;td&gt;@{item}@&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
</pre>
<a name="iterate-elem.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#items {
  plogic: {
    // iterate start tag, content, and end tag
    <strong>foreach (item in list) {</strong>
      @stag;
      @cont;
      @etag;
    <strong>}</strong>
  }
}
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
&lt;table&gt;
&lt;% for item in list do %&gt;
  &lt;tr&gt;
   &lt;td&gt;&lt;%= item %&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;% end %&gt;
&lt;/table&gt;

### for PHP
&lt;table&gt;
&lt;?php foreach ($list as $item) { ?&gt;
  &lt;tr&gt;
   &lt;td&gt;&lt;?php echo $item; ?&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;?php } ?&gt;
&lt;/table&gt;

### for JSTL
&lt;table&gt;
&lt;c:forEach var="item" items="${list}"&gt;
  &lt;tr&gt;
   &lt;td&gt;&lt;c:out value="${item}" escapeXml="false"/&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/c:forEach&gt;
&lt;/table&gt;

### for Velocity
&lt;table&gt;
#foreach($item in $list)
  &lt;tr&gt;
   &lt;td&gt;$!{item}&lt;/td&gt;
  &lt;/tr&gt;
#end
&lt;/table&gt;
</pre>
<br>

<a name="iterate-elem-supplement"></a>
<h4 class="section3">Supplement</h4>
<p>Kwartz directive <code>id="foreach:<em>item</em>=<em>list</em>"</code> lets you to use this pattern without presentation logic file.
</p>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;table&gt;
  &lt;tr <strong>id="foreach:item=list"</strong>&gt;
   &lt;td&gt;@{item}@&lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;
</pre>
<br>

<br>


<a name="iterate-cont"></a>
<h3 class="section2">Iterate Content Pattern</h3>
<a name="iterate-cont-desc"></a>
<h4 class="section3">Description</h4>
<p>Iteration which contains only <code>@cont</code> represents to iterate the content.
This pattern is named 'Iterate Content' pattern.
</p>
<br>

<a name="iterate-cont-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern is very useful when creating &lt;dl&gt;&lt;/dl&gt; list or table which repeats several rows.
</p>
<br>

<a name="iterate-cont-example"></a>
<h4 class="section3">Example Code</h4>
<a name="iterate-cont.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;dl <strong>id="mark:items"</strong>&gt;
  &lt;dt&gt;@{item.text}@&lt;/dt&gt;
  &lt;dd&gt;@{item.desc}@&lt;/dd&gt;
&lt;/dl&gt;
</pre>
<a name="iterate-cont.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#items {
  plogic: {
    // iterate only content
    @stag;
    <strong>foreach (item in list) {</strong>
      @cont;
    <strong>}</strong>
    @etag;
  }
}
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
&lt;dl&gt;
&lt;% for item in list do %&gt;
  &lt;dt&gt;&lt;%= item.text %&gt;&lt;/dt&gt;
  &lt;dd&gt;&lt;%= item.desc %&gt;&lt;/dd&gt;
&lt;% end %&gt;
&lt;/dl&gt;

### for PHP
&lt;dl&gt;
&lt;?php foreach ($list as $item) { ?&gt;
  &lt;dt&gt;&lt;?php echo $item-&gt;text; ?&gt;&lt;/dt&gt;
  &lt;dd&gt;&lt;?php echo $item-&gt;desc; ?&gt;&lt;/dd&gt;
&lt;?php } ?&gt;
&lt;/dl&gt;

### for JSTL
&lt;dl&gt;
&lt;c:forEach var="item" items="${list}"&gt;
  &lt;dt&gt;&lt;c:out value="${item.text}" escapeXml="false"/&gt;&lt;/dt&gt;
  &lt;dd&gt;&lt;c:out value="${item.desc}" escapeXml="false"/&gt;&lt;/dd&gt;
&lt;/c:forEach&gt;
&lt;/dl&gt;

### for Velocity
&lt;dl&gt;
#foreach($item in $list)
  &lt;dt&gt;$!{item.text}&lt;/dt&gt;
  &lt;dd&gt;$!{item.desc}&lt;/dd&gt;
#end
&lt;/dl&gt;
</pre>
<br>

<a name="iterate-cont-supplement"></a>
<h4 class="section3">Supplement</h4>
<p>Kwartz directive <code>id="loop:<em>item</em>=<em>list</em>"</code> lets you to use this pattern without presentation logic file.
</p>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;dl <strong>id="loop:item=list"</strong>&gt;
  &lt;dt&gt;@{item.text}@&lt;/dt&gt;
  &lt;dd&gt;@{item.desc}@&lt;/dd&gt;
&lt;/dl&gt;
</pre>
<br>

<br>


<br>


<a name="selection"></a>
<h2 class="section1">Selection</h2>
<a name="select-elem"></a>
<h3 class="section2">Select Element Pattern</h3>
<a name="select-elem-desc"></a>
<h4 class="section3">Description</h4>
<p>The following is an example to choose a certain element from some elements.
This pattern is named 'Select Element Pattern.'
</p>
<br>

<a name="select-elem-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern is very useful when you want to change data according to conditions.
</p>
<br>

<a name="select-elem-example"></a>
<h4 class="section3">Example Code</h4>
<a name="select-elem.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;div id="mark:message"&gt;
  &lt;span style="color:red"   <strong>id="mark:error"</strong>&gt;ERROR!&lt;/span&gt;
  &lt;span style="color:blue"  <strong>id="mark:warning"</strong>&gt;Warning:&lt;/span&gt;
  &lt;span style="color:black" <strong>id="mark:good"</strong>&gt;No error.&lt;/span&gt;
&lt;/div&gt;
</pre>
<a name="select-elem.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#message {
  plogic: {
    if (status == 'error') {
      <strong>@element(error);</strong>      // ERROR!
    } else if (status == 'warning') {
      <strong>@element(warning);</strong>    // Warning:
    } else {
      <strong>@element(good);</strong>       // No error.
    }
  }
}
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
&lt;% if status == "error" then %&gt;
  &lt;span style="color:red"&gt;ERROR!&lt;/span&gt;
&lt;% elsif status == "warning" then %&gt;
  &lt;span style="color:blue"&gt;Warning:&lt;/span&gt;
&lt;% else %&gt;
  &lt;span style="color:black"&gt;No error.&lt;/span&gt;
&lt;% end %&gt;

### for PHP
&lt;?php if ($status == "error") { ?&gt;
  &lt;span style="color:red"&gt;ERROR!&lt;/span&gt;
&lt;?php } elseif ($status == "warning") { ?&gt;
  &lt;span style="color:blue"&gt;Warning:&lt;/span&gt;
&lt;?php } else { ?&gt;
  &lt;span style="color:black"&gt;No error.&lt;/span&gt;
&lt;?php } ?&gt;

### for JSTL
&lt;c:choose&gt;&lt;c:when test="${status eq 'error'}"&gt;
  &lt;span style="color:red"&gt;ERROR!&lt;/span&gt;
&lt;/c:when&gt;&lt;c:when test="${status eq 'warning'}"&gt;
  &lt;span style="color:blue"&gt;Warning:&lt;/span&gt;
&lt;/c:when&gt;&lt;c:otherwise&gt;
  &lt;span style="color:black"&gt;No error.&lt;/span&gt;
&lt;/c:otherwise&gt;&lt;/c:choose&gt;

### for Velocity
#if($status == "error")
  &lt;span style="color:red"&gt;ERROR!&lt;/span&gt;
#elseif($status == "warning")
  &lt;span style="color:blue"&gt;Warning:&lt;/span&gt;
#else
  &lt;span style="color:black"&gt;No error.&lt;/span&gt;
#end
</pre>
<br>

<a name="select-elem-supplement"></a>
<h4 class="section3">Supplement</h4>
<p>Kwartz directive '<code>id="if:<em>condition</em>"</code>', '<code>id="elseif:<em>condition</em>"</code>', and '<code>id="else:"</code>'
let you to use this pattern without presentation logic file.
</p>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;div&gt;
  &lt;span style="color:red"   <strong>id="if:status=='error'"</strong>&gt;ERROR!&lt;/span&gt;
  &lt;span style="color:blue"  <strong>id="elseif:status=='warning'"</strong>&gt;Warning:&lt;/span&gt;
  &lt;span style="color:black" <strong>id="else:"</strong>&gt;No error.&lt;/span&gt;
&lt;/div&gt;
</pre>
<br>

<br>


<a name="pickup-elem"></a>
<h3 class="section2">Pick-up Element Pattern</h3>
<a name="pickup-elem-desc"></a>
<h4 class="section3">Description</h4>
<p>If you want to use certain elemnts, do marking the elements and use only them in presentation logic.
Elements which are not marked are ignored and not printed.
This pattern is named 'Pick-up Element Pattern.'
</p>
<p>'Pick-up Element' pattern is opposite of 'Dummy Element' pattern.
In 'Dummy Element' pattern, dummy elements are marked and removed so that necessary elements are leaved.
In 'Pick-up Element' pattern, necessary elements are marked and leaved so that dummy elements are removed.
</p>
<br>

<a name="pickup-elem-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern is useful when many dummy datas are exist.
</p>
<br>

<a name="pickup-elem-example"></a>
<h4 class="section3">Example Code</h4>
<a name="pickup-elem.pdata"></a>
<div class="program_caption">
Presentation Data:</div>
<pre class="program">&lt;html&gt;
  &lt;body&gt;
    &lt;div <strong>id="breadcrumbs"</strong>&gt;
      &lt;a href="/" <strong>id="mark:crumb"</strong>&gt;Home&lt;/a&gt;
      &lt;span <strong>id="mark:separator"</strong>&gt;&amp;gt;&lt;/span&gt;
      &lt;a href="/aaa/"&gt;AAA&lt;/a&gt; &amp;lt;
      &lt;a href="/aaa/bbb/"&gt;BBB&lt;/a&gt; &amp;lgt;
      &lt;a href="/aaa/bbb/ccc"&gt;CCC&lt;/a&gt; &amp;lgt;
      &lt;strong <strong>id="mark:title"</strong>&gt;@{title}@&lt;/strong&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<a name="pickup-elem.plogic"></a>
<div class="program_caption">
Presentation Logic:</div>
<pre class="program">#breadcrumbs {
  plogic: {
    foreach (item in list) {
      <strong>@element(crumb);</strong>          // print &lt;a&gt;...&lt;/a&gt;
      <strong>@element(separator);</strong>      // print '&amp;gt;'
    }
    <strong>@element(title);</strong>            // print &lt;b&gt;title&lt;/b&gt;
  }
}

#crumb {
  value:  item['name'];
  attrs:  "href" item['path'];
}
#title {
  value: title;
}
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
&lt;html&gt;
  &lt;body&gt;
&lt;% for item in list do %&gt;
      &lt;a href="&lt;%= item["path"] %&gt;"&gt;&lt;%= item["name"] %&gt;&lt;/a&gt;
      &amp;gt;
&lt;% end %&gt;
      &lt;strong&gt;&lt;%= title %&gt;&lt;/strong&gt;
  &lt;/body&gt;
&lt;/html&gt;

### for PHP
&lt;html&gt;
  &lt;body&gt;
&lt;?php foreach ($list as $item) { ?&gt;
      &lt;a href="&lt;?php echo $item["path"]; ?&gt;"&gt;&lt;?php echo $item["name"]; ?&gt;&lt;/a&gt;
      &amp;gt;
&lt;?php } ?&gt;
      &lt;strong&gt;&lt;?php echo $title; ?&gt;&lt;/strong&gt;
  &lt;/body&gt;
&lt;/html&gt;

### for JSTL
&lt;html&gt;
  &lt;body&gt;
&lt;c:forEach var="item" items="${list}"&gt;
      &lt;a href="&lt;c:out value="${item['path']}" escapeXml="false"/&gt;"&gt;&lt;c:out value="${item['name']}" escapeXml="false"/&gt;&lt;/a&gt;
      &amp;gt;
&lt;/c:forEach&gt;
      &lt;strong&gt;&lt;c:out value="${title}" escapeXml="false"/&gt;&lt;/strong&gt;
  &lt;/body&gt;
&lt;/html&gt;

### for Velocity
&lt;html&gt;
  &lt;body&gt;
#foreach($item in $list)
      &lt;a href="$!{item["path"]}"&gt;$!{item["name"]}&lt;/a&gt;
      &amp;gt;
#end
      &lt;strong&gt;$!{title}&lt;/strong&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<br>

<br>


<a name="extract-elem"></a>
<h3 class="section2">Extract Element Pattern</h3>
<a name="extract-elem-desc"></a>
<h4 class="section3">Description</h4>
<p>It is able to extract a certain element form the whole presentation data.
Other element and text strings are not printed.
This pattern is named 'Extract Element Pattern.'
</p>
<br>

<a name="extract-elem-situation"></a>
<h4 class="section3">Situation</h4>
<p>This pattern is very useful to extract HTML fragments and make them libraries.
</p>
<br>

<a name="extract-elem-example"></a>
<h4 class="section3">Example Code</h4>
<p>The following is an example to extract the HTML fragments 'tablist', 'menulist', and 'copyright' and generates the output scripts for them.
</p>
<a name="design.html"></a>
<div class="program_caption">
Presentation Data (<a href="design.html">design.html</a>):</div>
<pre class="program">&lt;html <strong>id="mark:whole"</strong>&gt;
  &lt;head&gt;
    &lt;title&gt;Design Examples&lt;/title&gt;
    &lt;link rel="stylesheet" href="design.css" type="text/css"&gt;
  &lt;/head&gt;
  &lt;body&gt;

    &lt;div <strong>id="mark:tablist"</strong>&gt;
      &lt;div class="tabs" id="mark:tabs"&gt;
        &lt;a href="/" class="" <strong>id="mark:tab"</strong>&gt;Home&lt;/a&gt;
        &lt;a href="/product/" class="selected"&gt;Product&lt;/a&gt;
        &lt;a href="/download/" class=""&gt;Download&lt;/a&gt;
        &lt;a href="/support/" class=""&gt;Support&lt;/a&gt;
      &lt;/div&gt;
      &lt;div class="tabsline"&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;br&gt;

    &lt;div <strong>id="mark:menulist"</strong>&gt;
      &lt;span class="menu_title" id="value:menu_title"&gt;MenuList&lt;/span&gt;
      &lt;div class="menus" <strong>id="mark:menus"</strong>&gt;
        &lt;a href="/cgi-bin/email.cgi" class="" <strong>id="mark:menu"</strong>&gt;E-Mail&lt;/a&gt;
        &lt;span <strong>id="mark:menu_separator"</strong>&gt;&lt;br&gt;&lt;/span&gt;
        &lt;a href="/cgi-bin/board.cgi" class="selected"&gt;MesgBoard&lt;/a&gt;&lt;br&gt;
        &lt;a href="/cgi-bin/photo.cgi" class=""&gt;PhotoAlbum&lt;/a&gt;&lt;br&gt;
        &lt;a href="/cgi-bin/greeting.cgi" class=""&gt;GreetingCard&lt;/a&gt;&lt;br&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;br&gt;
      
    &lt;p&gt; ..... &lt;/p&gt;
    &lt;p&gt; ..... &lt;/p&gt;
    &lt;p&gt; ..... &lt;/p&gt;
    
    &lt;div align="center" class="copyright" <strong>id="mark:copyright"</strong>&gt;
      Copyright&amp;copy; 2004-2005 kuwata-lab. All Rights Reserved.
    &lt;/div&gt;
    
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<a name="copyright.plogic"></a>
<div class="program_caption">
Presentation Logic (copyright.plogic):</div>
<pre class="program"><strong>#whole</strong> {
  // replace the element 'whole' with the element you want to extract
  plogic: {
    <strong>@element(copyright);</strong>
  }
}
</pre>
<a name="tablist.plogic"></a>
<div class="program_caption">
Presentation Logic (tablist.plogic):</div>
<pre class="program"><strong>#whole</strong> {
  // replace the element 'whole' with the element you want to extract
  plogic: {
    <strong>@element(tablist);</strong>
  }
}

#tabs {
  plogic: {
    @stag;
    foreach (tab in tablist) {
      klass = current_tabname == tab['name'] ? 'selected' : '';
      @element(tab);
    }
    @etag;
  }
}

#tab {
  value:  tab['name'];
  attrs:  "href" tab['href'], "class" klass;
}
</pre>
<a name="menulist.plogic"></a>
<div class="program_caption">
Presentation Logic (menulist.plogic):</div>
<pre class="program"><strong>#whole</strong> {
  // replace the element 'whole' with the element you want to extract
  plogic: {
    <strong>@element(menulist);</strong>
  }
}

#menus {
  plogic: {
    @stag;
    foreach (menu in menulist) {
      @element(menu);
      @element(menu_separator);
    }
    @etag;
  }
}

#menu {
  value:   menu['name'];
  attrs:   "href" menu['cgipath'], "class" klass;
  plogic: {
    klass = current_menu == menu['name'] ? 'selected' : '';
    @stag;
    @cont;
    @etag;
  }
}
</pre>
<div class="terminal_caption">
Compile:</div>
<pre class="terminal">### copyright
$ kwartz -l eruby -p copyright.plogic design.pdata
$ kwartz -l php   -p copyright.plogic design.pdata

### tablist
$ kwartz -l eruby -p tablist.plogic   design.pdata
$ kwartz -l php   -p tablist.plogic   design.pdata

### menulist
$ kwartz -l eruby -p menulist.plogic  design.pdata
$ kwartz -l php   -p menulist.plogic  design.pdata
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
    &lt;div align="center" class="copyright"&gt;
      Copyright&amp;copy; 2004-2005 kuwata-lab. All Rights Reserved.
    &lt;/div&gt;

### for PHP
    &lt;div align="center" class="copyright"&gt;
      Copyright&amp;copy; 2004-2005 kuwata-lab. All Rights Reserved.
    &lt;/div&gt;
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
    &lt;div&gt;
      &lt;div class="tabs"&gt;
&lt;% for tab in tablist do %&gt;
&lt;%   klass = current_tabname == tab["name"] ? "selected" : "" %&gt;
        &lt;a href="&lt;%= tab["href"] %&gt;" class="&lt;%= klass %&gt;"&gt;&lt;%= tab["name"] %&gt;&lt;/a&gt;
&lt;% end %&gt;
      &lt;/div&gt;
      &lt;div class="tabsline"&gt;
      &lt;/div&gt;
    &lt;/div&gt;

### for PHP
    &lt;div&gt;
      &lt;div class="tabs"&gt;
&lt;?php foreach ($tablist as $tab) { ?&gt;
&lt;?php   $klass = $current_tabname == $tab["name"] ? "selected" : ""; ?&gt;
        &lt;a href="&lt;?php echo $tab["href"]; ?&gt;" class="&lt;?php echo $klass; ?&gt;"&gt;&lt;?php echo $tab["name"]; ?&gt;&lt;/a&gt;
&lt;?php } ?&gt;
      &lt;/div&gt;
      &lt;div class="tabsline"&gt;
      &lt;/div&gt;
    &lt;/div&gt;
</pre>
<div class="output_caption">
Output Script:</div>
<pre class="output">### for eRuby
    &lt;div&gt;
      &lt;span class="menu_title"&gt;&lt;%= menu_title %&gt;&lt;/span&gt;
      &lt;div class="menus"&gt;
&lt;% for menu in menulist do %&gt;
&lt;%   klass = current_menu == menu["name"] ? "selected" : "" %&gt;
        &lt;a href="&lt;%= menu["cgipath"] %&gt;" class="&lt;%= klass %&gt;"&gt;&lt;%= menu["name"] %&gt;&lt;/a&gt;
        &lt;br&gt;
&lt;% end %&gt;
      &lt;/div&gt;
    &lt;/div&gt;

### for PHP
    &lt;div&gt;
      &lt;span class="menu_title"&gt;&lt;?php echo $menu_title; ?&gt;&lt;/span&gt;
      &lt;div class="menus"&gt;
&lt;?php foreach ($menulist as $menu) { ?&gt;
&lt;?php   $klass = $current_menu == $menu["name"] ? "selected" : ""; ?&gt;
        &lt;a href="&lt;?php echo $menu["cgipath"]; ?&gt;" class="&lt;?php echo $klass; ?&gt;"&gt;&lt;?php echo $menu["name"]; ?&gt;&lt;/a&gt;
        &lt;br&gt;
&lt;?php } ?&gt;
      &lt;/div&gt;
    &lt;/div&gt;
</pre>
<br>

<a name="extract-elem-supplement"></a>
<h4 class="section3">Supplement</h4>
<p>The command-line option <code>--extract=<em>name</em></code> extracts the element marked with <code><em>name</em></code> in Kwartz.
</p>
<br>

<br>


<br>



   </div>
  </blockquote>

 </body>
</html>
